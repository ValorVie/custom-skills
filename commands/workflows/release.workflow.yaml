# Release Workflow
# Complete release workflow for software projects
#
# This workflow guides version planning, changelog update, and release creation.
# Suitable for projects using semantic versioning and GitHub releases.
#
# Extended with enterprise-grade checklists, security checks, and multi-platform support.

name: release
version: 1.1.0
description: |
  Complete release workflow for software projects.
  Guides version planning, changelog update, and release creation.
  Includes security checks, multi-platform publishing, and team notification guidance.
  Keywords: release, publish, version, changelog, ç™¼å¸ƒ, ç‰ˆæœ¬.

metadata:
  author: universal-dev-standards
  category: release
  difficulty: intermediate
  estimated_steps: 7
  related_skills:
    - release-standards

prerequisites:
  - Git working directory clean (no uncommitted changes)
  - All features for this release merged
  - Tests passing on main/develop branch
  - Access to create GitHub releases
  - (Optional) GPG key configured for signed commits/tags

steps:
  # Step 1: Pre-release Verification
  - id: verify
    name: Pre-release Verification
    type: agent
    agent: test-specialist
    phase: preparation
    description: |
      Run pre-release checks to ensure codebase is ready.
      Execute ./scripts/pre-release-check.sh or equivalent.
      Includes security, license, and dependency checks.
    inputs:
      - project_config
    outputs:
      - verification_status
      - issues_found
      - security_report
    checklist:
      # Core verification
      - Git working directory clean
      - All tests passing
      - Linting passing
      - Version files in sync
      - Documentation up to date
      # Security & compliance (æ–°å¢)
      - Security vulnerabilities checked (npm audit / pip-audit / cargo audit)
      - No high/critical severity issues unresolved
      - License compatibility verified (license-checker / pip-licenses)
      - Dependencies up to date (npm outdated / pip list --outdated)
      - Breaking changes documented in CHANGELOG
    instructions: |
      **åŸºæœ¬æª¢æŸ¥ï¼š**
      ```bash
      # ç¢ºèª Git ç‹€æ…‹
      git status

      # åŸ·è¡Œæ¸¬è©¦
      npm test  # æˆ– pytest / cargo test

      # åŸ·è¡Œ linting
      npm run lint  # æˆ– flake8 / cargo clippy
      ```

      **Security Checksï¼ˆå®‰å…¨æª¢æŸ¥ï¼‰ï¼š**

      | æŠ€è¡“æ£§ | æŒ‡ä»¤ | èªªæ˜ |
      |--------|------|------|
      | Node.js | `npm audit --audit-level=high` | æª¢æŸ¥ npm å¥—ä»¶æ¼æ´ |
      | Node.js | `npx snyk test` | Snyk æ·±åº¦æƒæ |
      | Python | `pip-audit` | æª¢æŸ¥ PyPI å¥—ä»¶æ¼æ´ |
      | Python | `safety check` | Safety DB æª¢æŸ¥ |
      | Rust | `cargo audit` | æª¢æŸ¥ Cargo å¥—ä»¶æ¼æ´ |
      | Go | `govulncheck ./...` | Go æ¼æ´æª¢æŸ¥ |

      **è™•ç†å®‰å…¨æ¼æ´ï¼š**
      - HIGH/CRITICAL: å¿…é ˆä¿®å¾©å¾Œæ‰èƒ½ç™¼å¸ƒ
      - MEDIUM: å»ºè­°ä¿®å¾©ï¼Œæˆ–è¨˜éŒ„æ–¼ Release Notes
      - LOW: å¯æ¥å—ï¼Œè¿½è¹¤æ–¼ Issue

      **License Checksï¼ˆæˆæ¬Šæª¢æŸ¥ï¼‰ï¼š**
      ```bash
      # Node.js - æª¢æŸ¥æ‰€æœ‰ä¾è³´çš„æˆæ¬Š
      npx license-checker --summary
      npx license-checker --production --onlyAllow "MIT;Apache-2.0;BSD-2-Clause;BSD-3-Clause;ISC"

      # Python
      pip-licenses --format=markdown
      pip-licenses --allow-only="MIT;Apache-2.0;BSD"
      ```

      **å¸¸è¦‹ç›¸å®¹æˆæ¬Šï¼š**
      - âœ… MIT, Apache-2.0, BSD-2-Clause, BSD-3-Clause, ISC
      - âš ï¸ LGPLï¼ˆéœ€æ³¨æ„é€£çµæ–¹å¼ï¼‰
      - âŒ GPLï¼ˆè‹¥ç‚ºé–‰æºå°ˆæ¡ˆï¼‰

      **Dependency Freshnessï¼ˆä¾è³´æ›´æ–°ç‹€æ…‹ï¼‰ï¼š**
      ```bash
      # æª¢æŸ¥éæ™‚çš„ä¾è³´
      npm outdated              # Node.js
      pip list --outdated       # Python
      cargo outdated            # Rust (éœ€å®‰è£ cargo-outdated)
      ```

      - Major ç‰ˆæœ¬è½å¾Œï¼šè©•ä¼°æ˜¯å¦éœ€è¦å‡ç´š
      - æœ‰å·²çŸ¥å®‰å…¨æ¼æ´ï¼šå¿…é ˆå‡ç´š

  # Step 2: Plan Version
  - id: plan-version
    name: Plan Version
    type: manual
    phase: planning
    description: |
      Determine the version type and number for this release.
      Includes breaking change detection guidance.
    instructions: |
      **Version Types (Semantic Versioning):**

      | é¡å‹ | æ ¼å¼ | ä½¿ç”¨æ™‚æ©Ÿ |
      |------|------|----------|
      | MAJOR | X.0.0 | Breaking changesï¼Œä¸ç›¸å®¹çš„ API è®Šæ›´ |
      | MINOR | X.Y.0 | æ–°åŠŸèƒ½ï¼Œå‘å¾Œç›¸å®¹ |
      | PATCH | X.Y.Z | Bug ä¿®å¾©ï¼Œå‘å¾Œç›¸å®¹ |

      **Pre-release Tags:**

      | Tag | ç”¨é€” | ç©©å®šæ€§ |
      |-----|------|--------|
      | alpha | æ—©æœŸæ¸¬è©¦ï¼ŒAPI å¯èƒ½è®Šæ›´ | ä¸ç©©å®š |
      | beta | åŠŸèƒ½å®Œæ•´ï¼Œæ¸¬è©¦ä¸­ | è¼ƒç©©å®š |
      | rc | ç™¼å¸ƒå€™é¸ï¼Œæœ€çµ‚æ¸¬è©¦ | æ¥è¿‘ç©©å®š |

      **Example Version Formats:**
      - Stable: `1.2.3`
      - Beta: `1.2.3-beta.1`
      - Alpha: `1.2.3-alpha.1`
      - RC: `1.2.3-rc.1`

      ---

      **Breaking Change Detectionï¼ˆç ´å£æ€§è®Šæ›´åµæ¸¬ï¼‰ï¼š**

      æª¢æŸ¥ä»¥ä¸‹é …ç›®åˆ¤æ–·æ˜¯å¦ç‚º breaking changeï¼š

      | é¡åˆ¥ | æª¢æŸ¥é …ç›® | Breaking? |
      |------|----------|-----------|
      | API | å‡½å¼/æ–¹æ³•ç°½åè®Šæ›´ï¼ˆåƒæ•¸ã€å›å‚³å€¼ï¼‰ | âœ… |
      | API | ç§»é™¤å·²ç™¼å¸ƒçš„ public API | âœ… |
      | API | è®Šæ›´ API é è¨­è¡Œç‚º | âœ… |
      | Config | è¨­å®šæª”æ ¼å¼ä¸ç›¸å®¹è®Šæ›´ | âœ… |
      | Data | è³‡æ–™åº« schema ä¸ç›¸å®¹è®Šæ›´ | âœ… |
      | Env | æœ€ä½ç‰ˆæœ¬éœ€æ±‚æå‡ï¼ˆNode.jsã€Python ç­‰ï¼‰ | âœ… |
      | API | æ–°å¢å¯é¸åƒæ•¸ | âŒ |
      | API | æ–°å¢æ–°çš„ API | âŒ |
      | Fix | Bug ä¿®å¾©ï¼ˆå³ä½¿æ”¹è®Šè¡Œç‚ºï¼‰ | âŒ |

      **Deprecation Policyï¼ˆæ£„ç”¨æ”¿ç­–ï¼‰ï¼š**

      å»ºè­°çš„æ£„ç”¨æµç¨‹ï¼š
      1. **MINOR ç‰ˆæœ¬**ï¼šæ¨™è¨˜ deprecatedï¼ŒåŠ å…¥è­¦å‘Šè¨Šæ¯
         ```javascript
         /** @deprecated Use newFunction() instead. Will be removed in v3.0.0 */
         function oldFunction() { ... }
         ```
         ```python
         import warnings
         warnings.warn("oldFunction is deprecated, use newFunction instead", DeprecationWarning)
         ```
      2. **ä¸‹ä¸€å€‹ MAJOR ç‰ˆæœ¬**ï¼šç§»é™¤ deprecated åŠŸèƒ½
      3. åœ¨ CHANGELOG çš„ Deprecated section è¨˜éŒ„

      **ç‰ˆæœ¬æ±ºç­–æµç¨‹ï¼š**
      ```
      æœ‰ breaking changesï¼Ÿ
        â”œâ”€ æ˜¯ â†’ MAJOR (X.0.0)
        â””â”€ å¦ â†’ æœ‰æ–°åŠŸèƒ½ï¼Ÿ
                  â”œâ”€ æ˜¯ â†’ MINOR (X.Y.0)
                  â””â”€ å¦ â†’ PATCH (X.Y.Z)
      ```

      **æ±ºå®šç‰ˆæœ¬è™Ÿæ™‚è€ƒæ…®ï¼š**
      1. æœ¬æ¬¡ç™¼å¸ƒåŒ…å«å“ªäº›è®Šæ›´ï¼Ÿ
      2. æ˜¯å¦æœ‰ç ´å£æ€§è®Šæ›´ï¼ˆbreaking changesï¼‰ï¼Ÿ
      3. æ˜¯å¦éœ€è¦å…ˆç™¼å¸ƒé ç™¼å¸ƒç‰ˆæœ¬é€²è¡Œæ¸¬è©¦ï¼Ÿ
      4. ä¸Šæ¬¡ç™¼å¸ƒåˆ°ç¾åœ¨çš„è®Šæ›´é‡ï¼Ÿ
    inputs:
      - verification_status
    outputs:
      - version_type
      - new_version
      - release_type
      - has_breaking_changes
    checklist:
      - Version type selected (major/minor/patch)
      - New version number determined
      - Release type decided (stable/beta/alpha/rc)
      - Breaking changes identified and documented
      - Deprecation notices added (if applicable)

  # Step 3: Update CHANGELOG
  - id: update-changelog
    name: Update CHANGELOG
    type: agent
    agent: doc-writer
    phase: documentation
    description: |
      Update CHANGELOG.md with changes for this release.
      Follow Keep a Changelog format.
      Includes guidance for auto-generating from commits and PRs.
    inputs:
      - new_version
      - has_breaking_changes
    outputs:
      - changelog_entry
    checklist:
      - Added section for new version
      - Date included (YYYY-MM-DD format)
      - Changes categorized (Added/Changed/Fixed/Deprecated/Removed/Security)
      - Breaking changes clearly marked (âš ï¸)
      - Links updated (comparison URL)
      - Issue/PR references included
    instructions: |
      **CHANGELOG Format (Keep a Changelog):**

      ```markdown
      ## [X.Y.Z] - YYYY-MM-DD

      ### Added
      - New features

      ### Changed
      - Changes in existing functionality

      ### Deprecated
      - Soon-to-be removed features

      ### Removed
      - Removed features

      ### Fixed
      - Bug fixes

      ### Security
      - Security fixes
      ```

      ---

      **è‡ªå‹•ç”Ÿæˆè®Šæ›´ä¾†æºï¼š**

      å¯å¾ä»¥ä¸‹ä¾†æºæ”¶é›†è®Šæ›´ï¼š

      1. **Git Commitsï¼š**
         ```bash
         # åˆ—å‡ºä¸Šæ¬¡ release åˆ°ç¾åœ¨çš„æ‰€æœ‰ commits
         git log --oneline vPREV..HEAD

         # æ›´è©³ç´°çš„æ ¼å¼
         git log --pretty=format:"- %s (%h)" vPREV..HEAD
         ```

      2. **GitHub Pull Requestsï¼š**
         ```bash
         # åˆ—å‡ºå·²åˆä½µçš„ PR
         gh pr list --state merged --base main --limit 50

         # æŸ¥çœ‹ç‰¹å®š PR çš„è©³ç´°è³‡è¨Š
         gh pr view <number>
         ```

      3. **GitHub Issuesï¼ˆæ¨™è¨˜ç‚º changelogï¼‰ï¼š**
         ```bash
         gh issue list --label changelog --state closed
         ```

      ---

      **Conventional Commits å°æ‡‰è¡¨ï¼š**

      | Commit Type | CHANGELOG Section | èªªæ˜ |
      |-------------|-------------------|------|
      | `feat:` | Added | æ–°åŠŸèƒ½ |
      | `fix:` | Fixed | Bug ä¿®å¾© |
      | `perf:` | Changed | æ•ˆèƒ½æ”¹å–„ |
      | `refactor:` | Changed | é‡æ§‹ï¼ˆç„¡åŠŸèƒ½è®Šæ›´ï¼‰ |
      | `docs:` | (é€šå¸¸çœç•¥) | æ–‡ä»¶æ›´æ–° |
      | `style:` | (é€šå¸¸çœç•¥) | æ ¼å¼èª¿æ•´ |
      | `test:` | (é€šå¸¸çœç•¥) | æ¸¬è©¦ç›¸é—œ |
      | `chore:` | (é€šå¸¸çœç•¥) | ç¶­è­·ä»»å‹™ |
      | `BREAKING CHANGE:` | Changed (æ¨™è¨˜ âš ï¸) | ç ´å£æ€§è®Šæ›´ |
      | `security:` | Security | å®‰å…¨ä¿®å¾© |
      | `deprecate:` | Deprecated | æ£„ç”¨åŠŸèƒ½ |

      ---

      **æ’°å¯«æŒ‡å¼•ï¼š**

      âœ… **DO:**
      - é¢å‘ä½¿ç”¨è€…æ’°å¯«ï¼Œéé–‹ç™¼è€…
      - èªªæ˜ã€Œå½±éŸ¿ã€è€Œéã€Œå¯¦ä½œç´°ç¯€ã€
      - åŒ…å«ç›¸é—œ Issue/PR é€£çµ
      - Breaking changes ä½¿ç”¨ âš ï¸ æ¨™è¨˜

      **Good Example:**
      ```markdown
      ### Added
      - Add support for custom themes (#123)
      - New `--verbose` flag for detailed output (#125)

      ### Changed
      - âš ï¸ **BREAKING**: Configuration file format changed from JSON to YAML
        - Migration guide: [docs/migration-v3.md](docs/migration-v3.md)

      ### Fixed
      - Fix crash when input file is empty (#128)
      ```

      âŒ **DON'T:**
      ```markdown
      ### Changed
      - Refactored the config parser module
      - Updated dependencies
      - Fixed typo in variable name
      ```

      ---

      **ç‰ˆæœ¬é€£çµï¼ˆåº•éƒ¨ï¼‰ï¼š**
      ```markdown
      [X.Y.Z]: https://github.com/owner/repo/compare/vPREV...vX.Y.Z
      [PREV]: https://github.com/owner/repo/compare/vOLDER...vPREV
      ```

  # Step 4: Sync Version Files
  - id: sync-versions
    name: Sync Version Files
    type: agent
    agent: code-architect
    phase: execution
    description: |
      Update version in all required files.
      Ensure all version references are synchronized.
      Includes multi-technology stack examples.
    inputs:
      - new_version
      - release_type
    outputs:
      - files_updated
    checklist:
      - package.json updated (if Node.js)
      - pyproject.toml updated (if Python)
      - Other version files synced (project-specific)
      - Version strings consistent across all files
      - Lock files regenerated if needed
    instructions: |
      **å¸¸è¦‹ç‰ˆæœ¬æª”æ¡ˆä½ç½®ï¼š**

      | æŠ€è¡“æ£§ | æª”æ¡ˆ | æ¬„ä½/æ ¼å¼ |
      |--------|------|-----------|
      | Node.js | `package.json` | `"version": "X.Y.Z"` |
      | Node.js | `package-lock.json` | è‡ªå‹•æ›´æ–°ï¼ˆnpm install å¾Œï¼‰ |
      | Python | `pyproject.toml` | `[project] version = "X.Y.Z"` |
      | Python | `setup.py` | `version="X.Y.Z"` |
      | Python | `__init__.py` | `__version__ = "X.Y.Z"` |
      | Rust | `Cargo.toml` | `[package] version = "X.Y.Z"` |
      | Java/Gradle | `build.gradle` | `version = "X.Y.Z"` |
      | Java/Maven | `pom.xml` | `<version>X.Y.Z</version>` |
      | Go | `version.go` | `const Version = "X.Y.Z"` |
      | General | `VERSION` | Plain text: `X.Y.Z` |
      | General | `.version` | Plain text: `X.Y.Z` |
      | Docs | `README.md` | Badge URL æˆ– Version æ¬„ä½ |

      ---

      **æ›´æ–°æŒ‡ä»¤ç¯„ä¾‹ï¼š**

      **Node.js:**
      ```bash
      # æ›´æ–° package.jsonï¼ˆä¸è‡ªå‹•å»ºç«‹ git tagï¼‰
      npm version X.Y.Z --no-git-tag-version

      # æˆ–æ‰‹å‹•ç·¨è¼¯å¾Œé‡æ–°å®‰è£ä»¥æ›´æ–° lock file
      npm install
      ```

      **Python (ä½¿ç”¨ bump2version):**
      ```bash
      # å®‰è£
      pip install bump2version

      # æ›´æ–°ç‰ˆæœ¬
      bump2version patch  # æˆ– minor / major
      bump2version --new-version X.Y.Z patch
      ```

      **é€šç”¨ (sed):**
      ```bash
      # macOS
      sed -i '' 's/OLD_VERSION/NEW_VERSION/g' file

      # Linux
      sed -i 's/OLD_VERSION/NEW_VERSION/g' file
      ```

      ---

      **Monorepo è€ƒé‡ï¼š**

      | ç­–ç•¥ | èªªæ˜ | é©ç”¨å ´æ™¯ |
      |------|------|----------|
      | Fixed/Locked | æ‰€æœ‰ packages ä½¿ç”¨ç›¸åŒç‰ˆæœ¬ | ç·Šå¯†è€¦åˆçš„å°ˆæ¡ˆ |
      | Independent | æ¯å€‹ package ç¨ç«‹ç‰ˆæœ¬ | é¬†æ•£è€¦åˆçš„å°ˆæ¡ˆ |

      **å¸¸ç”¨ Monorepo å·¥å…·ï¼š**
      - **Lerna**: `lerna version --conventional-commits`
      - **Changesets**: `npx changeset version`
      - **Turborepo**: é…åˆ changesets ä½¿ç”¨

      ---

      **UDS å°ˆæ¡ˆç‰ˆæœ¬æª”æ¡ˆï¼ˆä¾›åƒè€ƒï¼‰ï¼š**
      ```
      cli/package.json              â†’ "version"
      cli/standards-registry.json   â†’ "version" (3 places)
      .claude-plugin/plugin.json    â†’ "version"
      .claude-plugin/marketplace.json â†’ "version"
      README.md                     â†’ **Version**: (stable only)
      ```

  # Step 5: Commit and Tag
  - id: commit-tag
    name: Commit and Tag
    type: manual
    phase: execution
    description: |
      Create git commit and tag for the release.
      Includes GPG signing and protected branch handling.
    instructions: |
      **åŸºæœ¬æµç¨‹ï¼š**

      1. **Stage all changed files:**
         ```bash
         git add -A
         ```

      2. **Commit with release message:**
         ```bash
         git commit -m "chore(release): vX.Y.Z"
         ```

      3. **Create annotated tag:**
         ```bash
         git tag -a vX.Y.Z -m "Release vX.Y.Z"
         ```

      4. **Push commit and tags:**
         ```bash
         git push && git push --tags
         ```

      **Note:** Replace X.Y.Z with the actual version number.

      ---

      **GPG ç°½åï¼ˆå»ºè­°ç”¨æ–¼æ­£å¼ç™¼å¸ƒï¼‰ï¼š**

      GPG ç°½åå¯é©—è­‰ commit/tag ç¢ºå¯¦ä¾†è‡ªæˆæ¬Šçš„ç™¼å¸ƒè€…ã€‚

      ```bash
      # æª¢æŸ¥ GPG è¨­å®š
      git config --get user.signingkey

      # ç°½å commit
      git commit -S -m "chore(release): vX.Y.Z"

      # ç°½å tag
      git tag -s vX.Y.Z -m "Release vX.Y.Z"

      # é©—è­‰ tag ç°½å
      git verify-tag vX.Y.Z

      # è¨­å®šé è¨­ç°½åï¼ˆå…¨åŸŸï¼‰
      git config --global commit.gpgsign true
      git config --global tag.gpgsign true
      ```

      **GitHub é¡¯ç¤ºï¼š**
      - ç°½åçš„ commits æœƒé¡¯ç¤º "Verified" ç¶ è‰²æ¨™ç±¤

      ---

      **Protected Branch è™•ç†ï¼š**

      è‹¥ main/master åˆ†æ”¯æœ‰ä¿è­·è¦å‰‡ï¼ˆå¦‚éœ€è¦ PR å¯©æ ¸ï¼‰ï¼š

      **æ–¹æ³• 1ï¼šRelease Branchï¼ˆæ¨è–¦ï¼‰**
      ```bash
      # 1. å»ºç«‹ release branch
      git checkout -b release/vX.Y.Z

      # 2. åœ¨æ­¤ branch å®Œæˆç‰ˆæœ¬æ›´æ–°
      git add -A
      git commit -m "chore(release): vX.Y.Z"

      # 3. æ¨é€ä¸¦å»ºç«‹ PR
      git push -u origin release/vX.Y.Z
      gh pr create --title "Release vX.Y.Z" --body "Release preparation"

      # 4. PR é€šéå¯©æ ¸å¾Œåˆä½µ

      # 5. åœ¨ main ä¸Šå»ºç«‹ tag
      git checkout main
      git pull
      git tag -a vX.Y.Z -m "Release vX.Y.Z"
      git push --tags
      ```

      **æ–¹æ³• 2ï¼šBranch Protection Exception**
      - åœ¨ repo settings ä¸­ç‚º release bot æˆ–ç‰¹å®šç”¨æˆ¶è¨­å®š bypass

      ---

      **Tag å‘½åæ…£ä¾‹ï¼š**

      | æ ¼å¼ | ç¯„ä¾‹ | èªªæ˜ |
      |------|------|------|
      | æœ‰ v prefix | `v1.2.3` | è¼ƒå¸¸è¦‹ |
      | ç„¡ v prefix | `1.2.3` | éƒ¨åˆ†å°ˆæ¡ˆä½¿ç”¨ |
      | Pre-release | `v1.2.3-beta.1` | é ç™¼å¸ƒç‰ˆæœ¬ |

      âš ï¸ **é‡è¦ï¼šé¸å®šä¸€ç¨®æ ¼å¼å¾Œä¿æŒä¸€è‡´ï¼**

    inputs:
      - new_version
      - files_updated
    outputs:
      - commit_sha
      - tag_name
    checklist:
      - All changes staged
      - Commit created with proper message
      - Tag created with proper format (annotated)
      - GPG signed (if configured)
      - Pushed to remote
      - Protected branch rules satisfied

  # Step 6: Create GitHub Release
  - id: create-release
    name: Create GitHub Release
    type: manual
    phase: execution
    description: |
      Create GitHub Release from the tag.
      Includes multi-platform publishing options.
    instructions: |
      **GitHub Releaseï¼ˆä¸»è¦ï¼‰ï¼š**

      **Option 1: GitHub CLI (æ¨è–¦)**
      ```bash
      # å¾æª”æ¡ˆè®€å– release notes
      gh release create vX.Y.Z \
        --title "vX.Y.Z" \
        --notes-file RELEASE_NOTES.md

      # æˆ–å…§åµŒ notes
      gh release create vX.Y.Z \
        --title "vX.Y.Z" \
        --notes "$(cat <<'EOF'
      ## What's Changed
      - Feature 1
      - Bug fix 2

      **Full Changelog**: https://github.com/owner/repo/compare/vPREV...vX.Y.Z
      EOF
      )"
      ```

      **Pre-release:**
      ```bash
      gh release create vX.Y.Z-beta.1 \
        --title "vX.Y.Z Beta 1" \
        --prerelease \
        --notes "Beta release for testing. Not recommended for production."
      ```

      **Option 2: GitHub Web UI**
      1. Repository â†’ Releases â†’ "Draft a new release"
      2. Select the tag (vX.Y.Z)
      3. Set title: vX.Y.Z
      4. Copy CHANGELOG entry as release notes
      5. Check "Set as the latest release" (for stable)
      6. Click "Publish release"

      ---

      **npm ç™¼å¸ƒï¼ˆNode.js å°ˆæ¡ˆï¼‰ï¼š**

      ```bash
      # Stable release (latest tag)
      npm publish

      # Beta release
      npm publish --tag beta

      # Alpha release
      npm publish --tag alpha

      # Dry runï¼ˆæ¸¬è©¦ï¼Œä¸å¯¦éš›ç™¼å¸ƒï¼‰
      npm publish --dry-run

      # é©—è­‰ç™¼å¸ƒ
      npm info <package-name> versions
      ```

      **npm 2FA æ³¨æ„äº‹é …ï¼š**
      - è‹¥å•Ÿç”¨ 2FAï¼Œå¯èƒ½éœ€è¦ `--otp=XXXXXX`
      - æˆ–ä½¿ç”¨ automation tokenï¼ˆCI/CD ç”¨ï¼‰

      ---

      **PyPI ç™¼å¸ƒï¼ˆPython å°ˆæ¡ˆï¼‰ï¼š**

      ```bash
      # å®‰è£å»ºç½®å·¥å…·
      pip install build twine

      # å»ºç½®
      python -m build

      # ä¸Šå‚³åˆ° PyPI
      twine upload dist/*

      # æˆ–å…ˆæ¸¬è©¦ï¼ˆTestPyPIï¼‰
      twine upload --repository testpypi dist/*
      pip install --index-url https://test.pypi.org/simple/ <package-name>
      ```

      **PyPI API Token:**
      - å»ºè­°ä½¿ç”¨ project-scoped token
      - è¨­å®š `~/.pypirc` æˆ–ç’°å¢ƒè®Šæ•¸ `TWINE_USERNAME=__token__`

      ---

      **Docker Imageï¼ˆå®¹å™¨åŒ–å°ˆæ¡ˆï¼‰ï¼š**

      ```bash
      # Build
      docker build -t myapp:vX.Y.Z .

      # å¤šé‡ tag
      docker tag myapp:vX.Y.Z myapp:latest
      docker tag myapp:vX.Y.Z myapp:X.Y
      docker tag myapp:vX.Y.Z myapp:X

      # Push to registry
      docker push myapp:vX.Y.Z
      docker push myapp:latest

      # Multi-platform build (ARM + AMD64)
      docker buildx build --platform linux/amd64,linux/arm64 \
        -t myapp:vX.Y.Z --push .
      ```

      ---

      **ç™¼å¸ƒ Assetsï¼ˆäºŒé€²ä½æª”æ¡ˆï¼‰ï¼š**

      ```bash
      # ä¸Šå‚³ assets åˆ° GitHub Release
      gh release upload vX.Y.Z ./dist/myapp-linux-amd64 ./dist/myapp-darwin-amd64

      # ç”¢ç”Ÿ checksums
      sha256sum ./dist/* > checksums.txt
      gh release upload vX.Y.Z checksums.txt
      ```

      **å»ºè­°åŒ…å«çš„ Assetsï¼š**
      - Binary æª”æ¡ˆï¼ˆå„å¹³å°ï¼‰
      - SHA256 checksumsï¼ˆ`checksums.txt` æˆ– `.sha256`ï¼‰
      - ç°½åæª”æ¡ˆï¼ˆ`.sig` æˆ– `.asc`ï¼‰

    inputs:
      - tag_name
      - changelog_entry
      - release_type
    outputs:
      - release_url
      - package_published
    checklist:
      - Release created on GitHub
      - Correct tag selected
      - Release notes accurate
      - Pre-release flag set if applicable
      - Package published (npm/pypi/docker if applicable)
      - Assets uploaded (if applicable)
      - Checksums provided (if applicable)

  # Step 7: Post-release Tasks
  - id: post-release
    name: Post-release Tasks
    type: agent
    agent: doc-writer
    phase: verification
    description: |
      Verify release and perform post-release tasks.
      Includes notification and announcement guidance.
    inputs:
      - release_url
      - new_version
      - release_type
    outputs:
      - verification_complete
      - announcement_draft
    checklist:
      # Verification
      - Release published successfully
      - Package available (if npm/pypi/docker)
      - Documentation reflects new version
      # Housekeeping
      - README badges updated (version, build status)
      - Related issues closed with release note reference
      - Related PRs linked to release
      - Milestone closed (if using)
      # Communication
      - Announcement prepared (if major release)
      - Team notified
      # Operations
      - Monitoring alerts configured for new version (if applicable)
      - Rollback plan documented (if major release)
    instructions: |
      **é©—è­‰ç™¼å¸ƒï¼š**

      ```bash
      # GitHub Release
      gh release view vX.Y.Z

      # npm
      npm info <package-name> version
      npm info <package-name> dist-tags

      # PyPI
      pip index versions <package-name>

      # Docker
      docker pull myapp:vX.Y.Z
      docker inspect myapp:vX.Y.Z
      ```

      ---

      **Issue/PR æ¸…ç†ï¼š**

      ```bash
      # é—œé–‰ç›¸é—œ issues
      gh issue close <number> --comment "Fixed in vX.Y.Z"

      # æ‰¹æ¬¡æ›´æ–° milestone
      gh issue list --milestone "vX.Y.Z" --state open
      gh issue edit <number> --milestone "vX.Y.Z"

      # é—œé–‰ milestone
      gh api repos/{owner}/{repo}/milestones/{number} -X PATCH -f state=closed
      ```

      ---

      **é€šçŸ¥ç®¡é“ï¼ˆä¾éœ€è¦é¸ç”¨ï¼‰ï¼š**

      **1. Slack/Discord:**
      ```
      ğŸš€ Released <project> vX.Y.Z

      **Highlights:**
      â€¢ Feature A
      â€¢ Bug fix B

      ğŸ“¦ Install: `npm i <package>@X.Y.Z`
      ğŸ“ Release: <release_url>
      ```

      **2. Twitter/X:**
      ```
      ğŸ‰ <Project> vX.Y.Z is out!

      âœ¨ New: Feature A
      ğŸ› Fixed: Bug B

      ğŸ“¦ npm i <package>
      ğŸ“ Changelog: <url>

      #opensource #release
      ```

      **3. Email Newsletterï¼ˆé‡å¤§ç‰ˆæœ¬ï¼‰ï¼š**
      - è©³ç´°åŠŸèƒ½èªªæ˜
      - å‡ç´šæŒ‡å—
      - Breaking changes è­¦å‘Š

      **4. Blog Postï¼ˆMAJOR ç‰ˆæœ¬ï¼‰ï¼š**
      - ç‰ˆæœ¬é¡˜æ™¯èˆ‡æ–¹å‘
      - è©³ç´°åŠŸèƒ½ä»‹ç´¹
      - Migration guide
      - æ„Ÿè¬è²¢ç»è€…

      ---

      **README Badge æ›´æ–°ï¼š**

      ```markdown
      <!-- npm version badge -->
      ![npm version](https://img.shields.io/npm/v/<package-name>)

      <!-- pypi version badge -->
      ![PyPI version](https://img.shields.io/pypi/v/<package-name>)

      <!-- GitHub release badge -->
      ![GitHub release](https://img.shields.io/github/v/release/owner/repo)
      ```

      ---

      **Rollback Planï¼ˆé‡å¤§ç‰ˆæœ¬ï¼‰ï¼š**

      è¨˜éŒ„å›æ»¾æ­¥é©Ÿä»¥å‚™ä¸æ™‚ä¹‹éœ€ï¼š
      1. å¦‚ä½•å›æ»¾åˆ°å‰ä¸€ç‰ˆæœ¬
      2. è³‡æ–™åº«å›æ»¾æ­¥é©Ÿï¼ˆå¦‚æœ‰ migrationï¼‰
      3. ç›¸ä¾æœå‹™çš„è™•ç†
      4. é€šçŸ¥ç”¨æˆ¶çš„ç¯„æœ¬

      ---

      **ä¸‹ä¸€ç‰ˆæœ¬æº–å‚™ï¼š**

      ```bash
      # å»ºç«‹ä¸‹ä¸€å€‹ milestone
      gh api repos/{owner}/{repo}/milestones -X POST \
        -f title="vX.Y+1.0" \
        -f description="Next minor release"
      ```

outputs:
  - name: release_url
    description: URL to the published GitHub release
    format: url

  - name: new_version
    description: The version number that was released
    format: semver

  - name: changelog_entry
    description: The CHANGELOG content for this release
    format: markdown

  - name: security_report
    description: Security audit results from pre-release checks
    format: text

completion_criteria:
  - All pre-release checks passed (including security)
  - Version files synchronized
  - CHANGELOG updated with proper categorization
  - Git tag created and pushed (signed if configured)
  - GitHub release published
  - Package published to registry (if applicable)
  - Post-release verification completed
  - Team notified (if applicable)

# Project-specific configuration example
# Override this section for your project
project_config:
  # Example: UDS project version files
  # version_files:
  #   - cli/package.json
  #   - cli/standards-registry.json
  #   - .claude-plugin/plugin.json
  #   - .claude-plugin/marketplace.json
  #   - README.md (stable releases only)
  # pre_release_script: ./scripts/pre-release-check.sh
  # security_checks:
  #   - npm audit --audit-level=high
  # license_policy:
  #   allowed: [MIT, Apache-2.0, BSD-2-Clause, BSD-3-Clause, ISC]
  #   denied: [GPL-3.0, AGPL-3.0]
