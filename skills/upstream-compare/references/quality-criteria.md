# Quality Criteria Reference

## Recommendation Scoring

### 建議等級評分標準

upstream-sync 使用以下評分機制決定 `recommendation` 等級：

```python
score = 0

# 新功能加分
feat_count * 3

# 修復加分
fix_count * 2

# Skills 變更加分
skills_count * 2

# Agents 變更加分
agents_count * 2

# Commands 變更加分
commands_count * 1

# 新增檔案加分
files_added * 1
```

### 等級門檻

| 等級 | 分數範圍 | 說明 |
|------|----------|------|
| **High** | ≥ 10 | 建議優先整合 |
| **Medium** | 5-9 | 值得評估整合 |
| **Low** | 1-4 | 可選擇性整合 |
| **Skip** | 0 | 可跳過 |

## Change Type Weighting

### 變更類型權重

| 類型 | 權重 | 說明 |
|------|------|------|
| `feat` | 高 | 新功能，通常需要整合 |
| `fix` | 高 | 修復，可能解決已知問題 |
| `refactor` | 中 | 重構，改善程式碼品質 |
| `perf` | 中 | 效能改善 |
| `docs` | 低 | 文件更新，通常參考即可 |
| `chore` | 低 | 維護性工作 |
| `test` | 低 | 測試相關 |
| `style` | 低 | 格式調整 |

## Category Priority

### 檔案分類優先級

| 分類 | 優先級 | 整合建議 |
|------|--------|----------|
| `skills` | 最高 | 直接影響 AI 行為，優先評估 |
| `agents` | 高 | 影響子代理能力 |
| `commands` | 高 | 影響使用者指令 |
| `hooks` | 中 | 影響自動化流程 |
| `rules` | 中 | 影響行為規則 |
| `contexts` | 中 | 影響上下文注入 |
| `docs` | 低 | 參考但通常不需整合 |
| `other` | 低 | 視情況評估 |

## Decision Framework

### 決策流程

```
┌─────────────────────────────────────────┐
│            評估上游變更                  │
└─────────────────┬───────────────────────┘
                  ↓
    ┌─────────────────────────────┐
    │   有新的 skill/agent 變更？  │
    └─────────────┬───────────────┘
                  ↓
         ┌───────┴───────┐
         │               │
        是              否
         │               │
         ↓               ↓
    ┌─────────┐    ┌─────────────┐
    │ 優先評估 │    │ 檢查 feat/fix │
    └────┬────┘    └──────┬──────┘
         │                │
         ↓                ↓
    ┌─────────┐    ┌─────────────┐
    │ 詳細分析 │    │  有重要修復？ │
    │ 變更內容 │    └──────┬──────┘
    └────┬────┘           │
         │         ┌──────┴──────┐
         ↓         │             │
    ┌─────────┐   是            否
    │ 決定整合 │    │             │
    │ 優先級   │    ↓             ↓
    └─────────┘ ┌──────┐    ┌──────┐
                │評估整合│    │可跳過│
                └──────┘    └──────┘
```

## Integration Checklist

### 整合前檢查清單

- [ ] 確認變更不會破壞現有功能
- [ ] 檢查是否有命名衝突
- [ ] 確認相依性是否滿足
- [ ] 評估是否需要調整現有 skills
- [ ] 考慮是否需要保留本地自訂內容

### 整合後驗證

- [ ] 測試新增/修改的 skills
- [ ] 確認 trigger patterns 正常運作
- [ ] 檢查與其他 skills 的互動
- [ ] 更新 last-sync.yaml

## Risk Assessment Matrix

### 風險評估矩陣

| 變更類型 | 低影響 | 中影響 | 高影響 |
|----------|--------|--------|--------|
| 新增 | 低風險 | 低風險 | 中風險 |
| 修改 | 低風險 | 中風險 | 高風險 |
| 刪除 | 中風險 | 高風險 | 高風險 |
| 重命名 | 中風險 | 中風險 | 高風險 |

### 風險緩解策略

| 風險等級 | 建議策略 |
|----------|----------|
| 高風險 | 建立 proposal、詳細測試、分階段整合 |
| 中風險 | 評估影響、準備回滾方案 |
| 低風險 | 可直接整合、基本測試 |

## Best Practices

### 整合最佳實踐

1. **優先官方來源**
   - anthropic-skills 為標準功能的首選
   - 本地自訂僅用於特定領域需求

2. **保留本地化價值**
   - 雙語支援
   - 領域專屬內容
   - 與其他工具的整合

3. **維護簡潔性**
   - 避免重複功能
   - 移除過時內容
   - 保持目錄結構清晰

4. **文件化決策**
   - 記錄整合原因
   - 保存比較分析
   - 更新 CHANGELOG
